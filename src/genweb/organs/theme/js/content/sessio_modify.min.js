function hideAgreement(e){jQuery.ajax({type:"POST",url:e+"/hide-agreement",success:function(){window.location.reload()},error:function(){alert("Error en l'operació")}})}function deleteElement(e,t){let a=CSS.escape(e);jQuery.ajax({type:"POST",url:window.location.href.split("?")[0].replace(/\/$/,"")+"/deleteElement",data:{action:"delete",id:e,type:t},success:function(){jQuery("#"+a).fadeOut("slow",function(){$(this).remove()})},error:function(){alert("Error on deleting element"),window.location.reload()}})}$(document).ready(function(){let t=document.getElementById("modalPunt"),a=(t&&t.addEventListener("hidden.bs.modal",()=>{var e=t.querySelector("#new-punt-title");e&&(e.value="")}),document.getElementById("modalAcord")),o=(a&&a.addEventListener("hidden.bs.modal",()=>{var e=a.querySelector("#new-acord-title");e&&(e.value="")}),$(".createPunt").on("click",function(e){e.preventDefault(),e.stopPropagation();e=$("#new-punt-title").val();e&&""!==e.trim()?$.ajax({type:"POST",url:window.location.href.split("?")[0].replace(/\/$/,"")+"/@@createElement",data:{action:"createPunt",name:e},success:function(){var e=bootstrap.Modal.getInstance(t);e&&e.hide(),refreshNeeded=!0},error:function(){alert("Hi ha hagut un error al crear el punt.")}}):alert("El títol no pot estar buit.")}),$(".createAcord").on("click",function(e){e.preventDefault(),e.stopPropagation();e=$("#new-acord-title").val();e&&""!==e.trim()?$.ajax({type:"POST",url:window.location.href.split("?")[0].replace(/\/$/,"")+"/@@createElement",data:{action:"createAcord",name:e},success:function(){var e=bootstrap.Modal.getInstance(a);e&&e.hide(),refreshNeeded=!0},error:function(){alert("Hi ha hagut un error al crear l'acord.")}}):alert("El títol no pot estar buit.")}),document.getElementById("modalConfirm"));o&&o.addEventListener("show.bs.modal",e=>{let t=e.relatedTarget;var e=t.getAttribute("data-modal-title"),a=t.getAttribute("data-modal-body");let n=t.getAttribute("data-modal-action");o.querySelector(".modal-title").textContent=e,o.querySelector(".modal-body").textContent=a;e=o.querySelector("#modalConfirmButton");$(e).off("click").on("click",function(){"delete"===n?deleteElement(t.getAttribute("data-item"),t.getAttribute("data-type")):"hideAgreement"===n&&hideAgreement(t.getAttribute("data-item-url")),bootstrap.Modal.getInstance(o).hide()})});var e=document.getElementById("modalEditTitle");if(e){let a=new bootstrap.Modal(e);$("#sortable").on("click",".edit, .edit2, a.editTitle",function(e){e.preventDefault(),e.stopPropagation();var e=$(this).data("id"),t=$(this).is("a")?$(this).text().trim():$(this).data("title");$("#edit-title-input").val(t),$("#edit-title-pk").val(e),a.show()}),$("#saveTitleButton").on("click",function(){let e=$("#edit-title-pk").val(),t=$("#edit-title-input").val();t?$.ajax({url:"changeTitle",type:"POST",data:{pk:e,value:t},success:function(){$('a.editTitle[data-id="'+e+'"]').text(t),$('button.edit[data-id="'+e+'"], button.edit2[data-id="'+e+'"]').data("title",t),a.hide()},error:function(){alert("Hi ha hagut un error al desar el títol.")}}):alert("El títol no pot estar buit.")})}$(".ui-sortable li").on("click",function(e){var t=$(this);t.hasClass("picked")||($(".ui-sortable li.picked").each(function(){$(this).removeClass("picked").find(".einesSpan, .show").toggleClass("einesSpan show"),$(this).find(".boleta").show()}),t.addClass("picked"),t.find(".einesSpan").toggleClass("einesSpan show"),t.find(".boleta").hide())}),$(window).on("click.Bst",function(e){0<$(e.target).closest(".modal").length||0===$(e.target).closest("#sortable").length&&$(".ui-sortable li.picked").each(function(){$(this).removeClass("picked").find(".einesSpan, .show").toggleClass("einesSpan show"),$(this).find(".boleta").show()})}),$("li.defaultValue").on("click",function(){var e=$(this).find(".bi-circle-fill").css("color"),t=$(this).closest(".btn-group");t.find(".bullet-toggle > i").css({color:e}),t.closest(".einesSpan").parent().find(".boleta > span > i").css({color:e})}),$("#importPointsButton").on("click",function(e){e.preventDefault(),e.stopPropagation();var t,e=$("#manual-import-text").val();e&&""!==e.trim()?((t=$("<form>",{method:"POST",action:window.location.href.split("?")[0].replace(/\/$/,"")+"/manualStructureCreation"})).append($("<input>",{type:"hidden",name:"form.widgets.message",value:e})),t.append($("<input>",{type:"hidden",name:"form.buttons.send",value:"Send"})),$("body").append(t),t.submit()):alert("El contingut no pot estar buit.")});let n=document.getElementById("modalPunts");n&&n.addEventListener("hidden.bs.modal",()=>{var e=n.querySelector("#manual-import-text");e&&(e.value="")})});